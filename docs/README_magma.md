# MAGMA

Software: https://ctg.cncr.nl/software/magma

MAGMA v1.10 (updated 10/01/2022): https://ctg.cncr.nl/software/MAGMA/prog/magma_v1.10.zip

Auxiliary files: located `/software/MAGMA/aux_files/`  
- `NCBI38/NCBI38.gene.loc`: Gene locations with build 38
- `NCBI37.3/NCBI37.3.gene.loc`: Gene locations with build 37

Resource:
- Boulder Workshop 2021의 MAGMA session
    - (pdf): `software/MAGMA/resources/boulder2021_partiii_posthuma.pdf`
    - practical resources: https://ibg.colorado.edu/cdrom2021/Day10-posthuma/magma_session/

# Example

Anorexia nervosa  
Article: https://www.nature.com/articles/s41588-019-0439-2  
Summary statistics available: https://figshare.com/articles/dataset/an2019/14671980  

결과:   
- Gene-wise analysis with MAGMA prioritized 79 Bonferroni-corrected significant genes, most within the multigenic locus on chromosome 3 (Supplementary Table 11).  
- MAGMA indicated an association with NCAM1 (Supplementary Table 11), the expression of which increases in response to food restriction in a rodent activity-based anorexia nervosa model.

Steps:  
1. Download summary statistics and leave only necessary columns
    - Script: `examples/magma/sumstat/01_minimize.py`
    - Input: `examples/magma/sumstat/pgcAN2.2019-07.vcf.tsv`
    - Output: `examples/magma/sumstat/pgcAN2.2019-07.vcf.minimal.tsv`

2. Generate SNPLOC file
    - Script: `examples/magma/01_snplist.py`
    - Input: `examples/magma/sumstat/pgcAN2.2019-07.vcf.minimal.tsv`
    - Output: `examples/magma/AN.snploc`

3. Perform gene annotation
    - Script: `examples/magma/02_gene_annot.sh`
    - Input:  
        - SNPLOC file: `examples/magma/AN.snp.loc`
            - 3 columns: SNP, Chromosome, Base position
            <details>
            <summary>Click to toggle contents of first 5 rows of snp.loc file</summary>

            ```
            rs62513865      8       101592213
            rs79643588      8       106973048
            rs17396518      8       108690829
            rs983166        8       108681675
            rs28842593      8       103044620
            ```

            </details>
        - GENELOC file: `software/MAGMA/aux_files/NCBI37.3/NCBI37.3.gene.loc`
            - 4 columns: Gene ID, Chromosome, Start site, Stop site, Strand, Gene name
            <details>
            <summary>Click to toggle contents of first 5 rows of gene.loc file</summary>

            ```
            79501   1       69091   70008   +       OR4F5
            100996442       1       142447  174392  -       LOC100996442
            729759  1       367659  368597  +       OR4F29
            81399   1       621096  622034  -       OR4F16
            148398  1       859993  879961  +       SAMD11
            ```

            </details>
    - Output:
        - log file: `examples/magma/AN.log`
            <details>
            <summary>Click to toggle contents of log file</summary>

            ```
            Welcome to MAGMA v1.10 (linux)
            Using flags:
                --annotate
                --snp-loc snploc
                --gene-loc ../../software/MAGMA/aux_files/NCBI37.3/NCBI37.3.gene.loc
                --out AN

            Start time is 17:33:12, Tuesday 21 Mar 2023

            Starting annotation...
            Reading gene locations from file ../../software/MAGMA/aux_files/NCBI37.3/NCBI37.3.gene.loc... 
                19427 gene locations read from file
                chromosome  1: 2016 genes
                chromosome  2: 1226 genes
                chromosome  3: 1050 genes
                chromosome  4: 745 genes
                chromosome  5: 856 genes
                chromosome  6: 1016 genes
                chromosome  7: 906 genes
                chromosome  8: 669 genes
                chromosome  9: 775 genes
                chromosome 10: 723 genes
                chromosome 11: 1275 genes
                chromosome 12: 1009 genes
                chromosome 13: 320 genes
                chromosome 14: 595 genes
                chromosome 15: 586 genes
                chromosome 16: 817 genes
                chromosome 17: 1147 genes
                chromosome 18: 271 genes
                chromosome 19: 1389 genes
                chromosome 20: 527 genes
                chromosome 21: 215 genes
                chromosome 22: 442 genes
                chromosome  X: 805 genes
                chromosome  Y: 47 genes
            Reading SNP locations from file snploc... 
                8219102 SNP locations read from file
                of those, 3282853 (39.94%) mapped to at least one gene
            Writing annotation to file AN.genes.annot
                for chromosome  1, 112 genes are empty (out of 2016)
                for chromosome  2, 27 genes are empty (out of 1226)
                for chromosome  3, 8 genes are empty (out of 1050)
                for chromosome  4, 26 genes are empty (out of 745)
                for chromosome  5, 16 genes are empty (out of 856)
                for chromosome  6, 19 genes are empty (out of 1016)
                for chromosome  7, 35 genes are empty (out of 906)
                for chromosome  8, 42 genes are empty (out of 669)
                for chromosome  9, 52 genes are empty (out of 775)
                for chromosome 10, 23 genes are empty (out of 723)
                for chromosome 11, 31 genes are empty (out of 1275)
                for chromosome 12, 11 genes are empty (out of 1009)
                for chromosome 13, 5 genes are empty (out of 320)
                for chromosome 14, 14 genes are empty (out of 595)
                for chromosome 15, 42 genes are empty (out of 586)
                for chromosome 16, 50 genes are empty (out of 817)
                for chromosome 17, 49 genes are empty (out of 1147)
                for chromosome 18, 5 genes are empty (out of 271)
                for chromosome 19, 52 genes are empty (out of 1389)
                for chromosome 20, 8 genes are empty (out of 527)
                for chromosome 21, 16 genes are empty (out of 215)
                for chromosome 22, 32 genes are empty (out of 442)
                for chromosome  X, 805 genes are empty (out of 805)
                for chromosome  Y, 47 genes are empty (out of 47)
                at least one SNP mapped to each of a total of 17900 genes (out of 19427)
            End time is 17:33:24, Tuesday 21 Mar 2023 (elapsed: 00:00:12)
            ```

            </details>
        - annot file: `examples/magma/AN.genes.annot`  
        2 + &#945; columns: Gene ID, CHR:StartSite:StopSite, &#945; number of annotated SNPs   
        <details>
        <summary>Click to toggle first 5 rows of annot file</summary>

        ```
        # window_up = 0
        # window_down = 0
        148398  1:859993:879961 rs6605067       rs2839
        26155   1:879583:894679 rs28631199      rs13303056      rs13302957      rs115438739     rs13303206      rs6605067       rs13303010      rs145470050     rs35678314      rs3748597       rs4970376       rs2839  rs4246503 rs3748596       rs4970377       rs4970371       rs13303051      rs13302945    rs3748592       rs4970452       rs6605069       rs41285806      rs4970375       rs3748595       rs10465242      rs3828047rs2340582        rs3828049       rs59986066      rs13303227      .       rs4970445
        339451  1:895967:901099 rs3935066       rs4970436       rs4970435       rs6677386       rs41285808      rs9697711       rs4970441       rs13303229      rs4970434       rs28393498      rs34612277      rs6605071rs13303351       rs6696971
        ```

        </details>

4. Generate PVAL file
    - Script: `examples/magma/03_pval.py`
    - Input: `examples/magma/sumstat/pgcAN2.2019-07.vcf.minimal.tsv`
    - Output: `examples/magma/AN.pval`  
        3 columns: SNP, P, N  
        <details>
        <summary>Click to toggle first 5 rows of pval file</summary>

        ```
        SNP     P       N
        rs62513865      0.7276  26020.955086393536
        rs79643588      0.9939  26020.955086393536
        rs17396518      0.4255  26020.955086393536
        rs983166        0.04361 26020.955086393536
        ```

        </details>

5. MAGMA gene-based analysis
    - Script: `examples/magma/04_genebased.sh`
    - Input:
        - Reference bfile: `software/MAGMA/reference/g1000_eur`
        - PVAL file: `examples/magma/AN.pval`
        - Gene annot file: `examples/magma/AN.genes.annot`
    - Output:
        - log file: `examples/magma/AN_genebased.log`
            <details>
            <summary>Click to toggle log of the gene-based analysis</summary>
            
            ```
            Welcome to MAGMA v1.10 (linux)
            Using flags:
                --bfile ../../software/MAGMA/reference/g1000_eur
                --pval AN.pval ncol=N
                --gene-annot AN.genes.annot
                --out AN

            Start time is 18:12:40, Tuesday 21 Mar 2023

            Loading PLINK-format data...
            Reading file ../../software/MAGMA/reference/g1000_eur.fam... 503 individuals read
            Reading file ../../software/MAGMA/reference/g1000_eur.bim... 22665064 SNPs read
            Preparing file ../../software/MAGMA/reference/g1000_eur.bed... 

            Reading SNP synonyms from file ../../software/MAGMA/reference/g1000_eur.synonyms (auto-detected)
                read 6016767 mapped synonyms from file, mapping to 3921040 SNPs in the data
                WARNING: detected 133 synonymous SNP pairs in the data
                        skipped all synonym entries involved, synonymous SNPs are kept in analysis
                        writing list of detected synonyms in data to supplementary log file
            Reading SNP p-values from file AN.pval... 
                detected 3 variables in file
                using variable: SNP (SNP id)
                using variable: P (p-value)
                using variable: N (sample size; discarding SNPs with N < 50)
                read 8219103 lines from file, containing valid SNP p-values for 7239998 SNPs in data (88.09% of lines, 31.94% of SNPs in data)
            Loading gene annotation from file AN.genes.annot... 
                17900 gene definitions read from file
                found 17825 genes containing valid SNPs in genotype data


            Starting gene analysis... 
                using model: SNPwise-mean
                writing gene analysis results to file AN.genes.out
                writing intermediate output to file AN.genes.raw


            End time is 18:21:20, Tuesday 21 Mar 2023 (elapsed: 00:08:40)

            ```

            </details>

        - genes.out: `examples/magma/AN_genebased.genes.out`
            <details>
            <summary>Click to toggle first 5 rows of genes.out file</summary>

            ```
            GENE       CHR      START       STOP  NSNPS  NPARAM      N        ZSTAT            P
            148398       1     859993     879961      2       1  16747       0.8693      0.19234
            26155        1     879583     894679     28       2  18026       1.0843      0.13912
            339451       1     895967     901099     13       2  16481      0.73712      0.23052
            ```

            </details>
        - genes.raw: `examples/magma/AN_genebased.genes.raw`
            <details>
            <summary>Click to toggle first 5 rows of genes.raw file</summary>

            ```
            # VERSION = 110
            # COVAR = NSAMP MAC
            148398 1 859993 879961 2 1 16747 50.5 0.869304
            26155 1 879583 894679 28 2 18026 58.4643 1.08427 0.970952
            339451 1 895967 901099 13 2 16481 72.6923 0.737121 0.90797 0.943449
            84069 1 901872 910488 1 1 15116 29 0.0903614 0.460495 0.4596 0.475637
            ```

            </details>
        - log.suppl: `examples/magma/AN_genebased.log.suppl`
            <details>
            <summary>Click to toggle the contents of log.suppl file</summary>

            ```
            ##### #####  SNP filtering  ##### #####
            # Following sets of synonymous SNP IDs were found in file ../../software/MAGMA/reference/g1000_eur.synonyms

            ##### #####  SNP synonym file  ##### #####
            # Following sets of synonymous SNP IDs were found in file ../../software/MAGMA/reference/g1000_eur.synonyms
            # All were retained in analysis, the corresponding synonym definitions were skipped
            rs74957513	rs144373027
            rs9274503	rs547195525
            rs73400724	rs539428778
            rs201496009	rs377174106
            rs562966368	rs567831738
            rs4307703	rs530786090
            rs536493456	rs548717541
            rs199939975	rs567200562
            rs34961787	rs552647776
            rs4421728	rs575470066
            rs200139700	rs377024834
            rs115310938	rs587656487
            rs201010807	rs587625153
            rs369632134	rs374852022
            rs542162887	rs587639051
            rs4281298	rs74882200
            rs115206239	rs587640557
            rs190435130	rs573357642
            rs61811540	rs587604831
            rs377201523	rs549004672
            rs200126887	rs201129882
            rs11485978	rs587733778
            rs200565358	rs562258831
            rs142733048	rs567970547
            rs200147310	rs201973475
            rs61414085	rs147654188
            rs11859869	rs138617138
            rs138920633	rs143363949
            rs2331418	rs534044076
            rs148094028	rs569987792
            rs9274171	rs548767328
            rs28463925	rs587729263
            rs76527351	rs372980169
            rs5936273	rs139948804
            rs2012404	rs370105587
            rs59953232	rs112313208
            rs74941663	rs199498802
            rs115382667	rs587690826
            rs374174270	rs547684136
            rs4892547	rs5981785
            rs145908821	rs148016274
            rs201177473	rs587707599
            rs62282469	rs78811112
            rs77996898	rs138812296
            rs200654296	rs540285531
            rs6648025	rs201657934
            rs5969955	rs138407404
            rs200601438	rs572191341
            rs140010048	rs554129713
            rs4236551	rs114766414
            rs3932194	rs542281151
            rs587739370	rs587752477
            rs117344158	rs587765833
            rs533971544	rs561703905
            rs61848845	rs202064490
            rs147186214	rs200600651
            rs114382683	rs587750081
            rs140574837	rs531774885
            rs562903882	rs587754870
            rs200504670	rs201949171	rs553395016
            rs2734961	rs144223821
            rs9442114	rs587609742
            rs28701660	rs111410510
            rs73541428	rs587678131
            rs368445657	rs573887893
            rs2508055	rs201528042
            rs9698711	rs547707036
            rs74836437	rs574689477
            rs137913146	rs143225797
            rs587637414	rs587675383
            rs56269016	rs113677337
            rs112378590	rs190040376
            rs11966284	rs139573925
            rs4236550	rs114224378
            rs6653830	rs112749816
            rs12393287	rs139917921
            rs199822737	rs373442268
            rs10761803	rs113519331
            rs11968585	rs143298684
            rs569335144	rs575320386
            rs9273736	rs531218774
            rs7188256	rs113082183
            rs530005491	rs587723228
            rs190089222	rs574982832
            rs1966167	rs56412553
            rs141563378	rs551525520
            rs199748333	rs201375109
            rs587599003	rs587607905
            rs544510430	rs587666294
            rs138141889	rs373469782
            rs140571210	rs147904363
            rs115546173	rs587730311
            rs55901629	rs143408842
            rs1131114	rs2853952
            rs200546373	rs587705517
            rs141344452	rs536957655
            rs201633113	rs530312336
            rs537060076	rs587640615
            rs151128163	rs587628531
            rs116000423	rs202126328
            rs34624093	rs185057992
            rs4380259	rs113092996
            rs58114990	rs200257916
            rs5943736	rs181966903
            rs146265282	rs201177106
            rs5929446	rs5929447
            rs3896058	rs587710355
            rs114041615	rs587680154
            rs7247683	rs587632277
            rs379344	rs558070530
            rs62282474	rs80085168
            rs556648079	rs587595377
            rs191201101	rs587625638
            rs36162247	rs112158820
            rs199834488	rs200651328	rs535044025
            rs535661078	rs539157308
            rs77023345	rs200897653
            rs201335236	rs563397158
            rs62317940	rs537034155
            rs569205311	rs577247495
            rs79556380	rs199629979
            rs10876801	rs11954641
            rs142058294	rs587726074
            rs367611759	rs368235517
            rs2545950	rs587638221
            rs560459208	rs587767198
            rs7516918	rs587676447
            rs7757696	rs9272994
            rs75732746	rs189834035
            rs367841254	rs374484056
            rs60712651	rs114457163
            rs3098019	rs76185201
            rs73541461	rs587759063
            ```

            </details>

6. MAGMA Gene-set analysis를 위해서 gene-set preparation  
이 예제에서는 MsigDB의 **Individual Human Gene Set GMTs** -> **C5: ontology gene sets** -> **CC: subset of GO** (GO Cellular Component ontology)를 이용해서 gene-set analysis를 진행해봄.  
Note: MAGMA gene들이 *Entrez gene IDs*로 되어있기 때문에, *NCBI (Entrez) Gene IDs*를 다운로드 함. `examples/magma/geneset/c5.go.bp.v2023.1.Hs.entrez.gmt`  
    <details>
    <summary>Click to toggle the contents of first 5 rows of gmt file</summary>

    ```
    GOBP_MITOCHONDRIAL_GENOME_MAINTENANCE	http://www.gsea-msigdb.org/gsea/msigdb/human/geneset/GOBP_MITOCHONDRIAL_GENOME_MAINTENANCE	10000	10891	11232	142	1763	1890	201163	201973	2021	219736	291	3980	4205	4358	4976	50484	5428	55186	56652	6240	64863	6742	7156	7157	79736	80119	83667	84275	9093	92667	9361
    GOBP_REPRODUCTION	http://www.gsea-msigdb.org/gsea/msigdb/human/geneset/GOBP_REPRODUCTION	100	10007	100125288	100130958	100130988	100131137	100137049	10017	10018	100289087	10038	10046	10049	100506013	100507650	10051	10096	10097	100996631	10111	10116	10134	10149	10155	1017	10179	10184	101927581	101928601	10265	1027	102724560	1028	10343	10361	10370	10388	10393	10403	10406	10407	10409	10420	10426	10461	10468	1047	10481	10491	10497	1051	10519	10522	10524	10549	10560	10566	10574	10575	10576	10592	1060	10609	10635	10653	10655	10657	10658	10661	1069	10694	10699	10732	10733	10734	10735	10744	10765	10766	107983988	1080	1081	10818	1082	10844	10863	10876	10881	109	10916	10919	10927	10935	10942	10959	10983	10991	11020	11022	11055	11057	11063	11077	11085	11086	11105	11144	11189	11218	11251	113	11315	11331	113451	113746	114112	114791	115948	116	116138	116369	1164	116832	117	117144	117154	117155	117285	119504	119710	120892	121355	122042	122258	122402	122664	1235	124404	124626	124783	124817	124912	125972	126206	126549	1268	1271	127579	128153	128497	128637	130399	130497	1307	130951	131118	131375	132141	132243	132612	132625	133	133308	133558	135138	135458	135927	135935	136242	136332	1364	136991	138474	1390	1392	139212	1393	1394	1396	139886	1399	140732	140801	140894	140947	142	143471	1435	143678	143689	144132	144195	144406	144455	144535	145645	1459	146310	146378	146845	146849	146852	146956	147650	147700	147872	147912	148229	148281	148327	149095	1495	149685	1499	150	150159	150221	150280	150365	1508	150921	151	151056	151195	151246	151254	151449	151648	152006	152015	1525	152586	153218	1538	1539	154197	1543	154313	1545	157506	157680	157695	157777	157855	158062	158401	1586	1588	1594	159686	1602	160762	161142	161514	1617	1618	161829	161931	1620	1621	162540	162979	163589	1636	164045	164091	1642	164395	164684	164714	1654	166378	167	1672	168391	169981	170370	170506	170690	171169	171482	171483	171484	1718	1730	1731	1738	1739	174	1761	1767	1785	1788	18	181	1811	1812	1816	182	1822	1828	183	1833	1843	1869	190	1906	1909	1910	1912	192670	1958	197342	199223	199720	2	200162	200232	200373	200558	201164	201254	2013	202051	202500	2026	203074	203102	203523	203611	204474	2054	2056	2057	2067	2069	207	2072	2099	2120	2175	2176	2177	2182	2185	2189	2192	219670	219771	219793	219938	219990	221400	221481	221656	221711	221823	222698	2241	2253	2254	2255	225689	226	2263	22803	22836	22862	22873	2288	22887	22917	22933	22948	2295	2296	22994	22999	2302	23064	23139	23157	23198	23205	23213	23230	23236	23291	23304	23310	23315	23318	23345	23353	23394	23397	23399	23411	23414	23424	2348	23492	2350	2352	2353	2354	23542	23598	23609	23617	23626	23627	23633	23639	23641	23705	23742	23762	23764	23780	24145	24149	245711	246184	246777	247	2475	2488	249	2491	2492	2515	2516	2528	2529	253175	253943	254394	254528	255061	255101	255220	255626	2560	256006	256126	256710	257044	257062	25777	25788	25790	25809	2583	25831	25836	25847	25858	259	25906	2591	25911	259266	2593	25932	25945	25976	25981	26003	26038	26064	26091	26108	26140	26165	261734	2620	26206	2622	2623	2625	26255	26256	2626	2627	26271	26292	26330	26471	26476	2649	26528	2660	26609	2661	2662	26664	2674	2678	268	2683	269	2692	2693	2695	2697	26998	27019	27030	2706	2707	2709	2712	27120	27125	27127	27136	27161	27175	27229	27285	27306	2735	2741	2743	27443	2796	2801	2827	283	283129	2834	283417	283471	283629	283677	283847	284067	284071	284338	284359	284382	284680	285	285335	285498	285588	286128	286151	286207	286234	286464	286826	2879	28981	2908	29118	29127	2956	2959	29781	29844	29882	29893	29924	29945	29947	29974	29988	30014	301	3010	3014	3024	3037	3066	3073	3074	30812	3148	3169	3171	3172	317719	317761	3205	3206	3207	3209	3235	3236	3239	3248	326340	3267	3291	3293	3295	3298	330	3301	3305	3306	3309	3364	3371	338	338323	338773	338879	339168	339345	339829	339834	339906	3400	340069	340719	340784	341277	341567	3417	342977	344018	344758	346288	346653	346673	347688	347732	3479	3480	3482	3485	3488	3490	349152	351	3516	353189	3549	3552	3553	3566	3593	361	3619	3620	3622	3623	3624	3625	3633	3640	3643	3645	367	3673	3675	3678	3688	3690	3691	3714	3726	373861	373863	374	374768	375189	3753	375337	375341	377630	378708	378807	378948	3791	3814	3815	383	3856	3857	387712	387885	3880	388336	388553	388649	388799	389320	389730	389761	389762	389763	389852	390243	391714	3948	3952	3953	3955	3965	397	3972	3973	3975	3976	3985	399949	400629	401024	4012	402381	402573	4033	4036	406	406949	406950	406991	4086	4089	409	4090	4117	412	4142	4179	4184	4188	4192	4201	4216	4221	4240	4254	4292	4313	431705	431707	4318	4323	4327	4342	4361	43847	440699	440804	440822	441161	441452	441531	442867	442868	4436	4438	4439	4486	4487	4488	449520	4521	4543	4603	4627	4678	4683	4693	472	4735	474343	4751	4753	4762	480	4808	4809	4824	4838	4846	4851	4861	4867	4878	4880	4882	4889	49	4914	4920	4926	493	494551	4948	4956	4957	497189	49855	4986	4987	4988	4991	5000	5010	5016	5017	5020	5021	5023	5028	5047	5048	50487	5049	5050	50511	5066	5069	5073	5079	50846	5087	51	5104	51087	5111	51156	51207	51247	5125	5127	51298	51314	51343	51361	5139	51433	51434	51441	51460	51465	51529	5154	51542	51547	5156	51574	5159	51665	51668	51673	51686	51738	51742	51759	5176	51804	51807	5224	5228	5232	5238	5241	5266	5268	5270	5310	5324	5327	53340	53405	5347	5350	5360	5367	5368	538	54106	5414	54361	54407	54456	54457	54466	54514	54558	54585	54586	546	5467	5469	54742	54760	54763	54851	54852	54888	54890	54937	54970	54993	55036	55063	55064	551	55120	55124	5515	5518	552	55231	55329	55339	55342	5535	55366	55521	55585	55636	5566	5568	55706	5571	55723	55726	55743	55779	558	55810	55811	55815	55818	55840	55870	55905	5591	56	5608	56154	56155	56158	56159	56163	56165	5617	5618	5619	5620	56262	56339	5660	56603	56648	5669	5670	5671	5672	56729	5673	5675	5676	56776	5678	5680	56848	56853	56907	56956	56977	56979	57054	57055	57082	57095	57097	57113	57119	57122	57135	57151	57178	5719	572	5724	5727	5729	5730	5737	5743	5744	57446	57587	57599	5764	57647	57697	57721	57728	57731	578	5781	57820	57828	57829	5798	5806	581	5810	5819	582	583	58494	585	58524	58531	5858	5864	5872	5885	5887	5888	5889	5890	5892	5901	5914	5916	5925	5926	59272	5932	59338	59343	59350	595	5950	596	5972	598	5987	599	5990	5997	6013	6019	604	6045	6046	60675	6092	6098	6117	6159	6194	619556	6196	6198	6299	6305	638	6382	63894	639	63946	63948	63950	63951	63978	63979	6406	6407	64100	6414	64147	64207	6422	64220	64224	6423	642623	642636	642658	64321	643376	64395	64396	644150	644186	64478	644890	64518	645832	64591	645961	646	6461	64645	646480	646799	64682	6469	647060	64750	64753	6477	64847	64848	6498	65010	65110	6513	652	6522	653	6532	654	655	657	6573	658	6586	659	6595	66037	6615	6627	6647	6652	6654	6658	666	6662	6665	6670	6674	6676	6677	668	6690	6691	6696	6714	6715	6716	6732	6736	675	6751	6752	6753	676	6768	6774	6777	6781	6788	6789	6790	6794	6795	6812	682	6833	6847	6863	6865	6866	6869	6870	6874	6875	6895	6901	6926	694	6943	6950	6954	699	7004	7005	701	7013	7016	7022	7026	7042	7043	7046	7048	7054	7056	7067	7068	7073	7076	7079	708	7080	7098	7103	7110	7130	7141	7142	7153	7155	7156	718	7182	7203	7216	7222	7225	7226	7257	7258	7272	727830	727905	728132	728137	7283	728395	728403	728637	728695	728712	729201	729967	7301	730249	7314	7320	7337	734	7345	7349	7351	7356	7372	7417	7421	7422	7425	7432	7455	7458	7473	7474	7476	7482	7484	7490	7516	7528	7536	7584	7589	768239	7704	7707	771	7783	7784	780	7812	7855	78995	79084	7917	79173	7932	79400	79582	796	79645	79670	79703	79727	79733	79747	79816	79820	79846	79893	79925	7993	79969	79977	79989	80000	80010	80025	80198	80217	80237	8031	80314	8061	80705	8085	8086	811	81492	81539	81616	81623	81626	81629	81671	81833	81892	81930	8195	8204	8239	824	8243	8287	8320	8322	83447	83449	835	83540	836	83639	83700	8372	8382	83853	83890	83893	83942	83943	8398	83983	8399	83990	84056	84057	84071	84072	84073	84074	841	84132	84152	84159	84168	84172	84203	84215	84221	84223	84225	84229	84236	8433	8434	8438	84464	84501	84515	84519	84660	84678	8468	84687	84688	84690	84691	84694	84733	84750	84812	84868	84930	84944	8510	8521	8528	8531	85315	85360	85376	85378	85413	85417	85438	8546	8549	8605	8607	8614	8626	8633	8644	8653	8654	867	8697	8701	8743	8747	8748	8749	875	8751	881	8820	8852	8879	8881	8890	8892	8893	8894	8900	8909	8912	8924	8932	89765	89766	898	89869	89876	89887	8999	90	9025	90410	90780	9082	9083	9085	90853	91	9104	9125	9126	9130	9133	9134	9148	9156	91603	91646	91746	9183	9184	9191	91978	92	9210	9232	9241	9271	928	9289	93185	9319	93426	9353	93649	9389	94027	9403	94107	9420	9421	9425	9426	9444	9463	9468	9509	9510	9514	9519	952	9575	9576	9612	9633	9665	9667	9698	9700	9702	9724	9825	983	989	9897	9898	991	9918	993	994	9940	995	996	9985
    GOBP_SINGLE_STRAND_BREAK_REPAIR	http://www.gsea-msigdb.org/gsea/msigdb/human/geneset/GOBP_SINGLE_STRAND_BREAK_REPAIR	100133315	1161	142	200558	2074	23411	3981	54840	55775	7014	7141	7515
    GOBP_REGULATION_OF_DNA_RECOMBINATION	http://www.gsea-msigdb.org/gsea/msigdb/human/geneset/GOBP_REGULATION_OF_DNA_RECOMBINATION	10039	10097	10111	10189	10459	10524	10635	10721	10856	10902	10933	11105	1111	112441434	113510	115004	116028	118460	121260	126549	132243	142	149840	151987	154288	158880	196528	200558	201516	2068	2074	2187	22891	22976	23028	23126	23347	23514	23529	2521	26122	29072	2956	30009	3005	3006	3007	3008	3009	3010	3024	341567	3558	3565	3575	3586	373861	3836	3838	4292	4361	441161	4436	4437	50943	51010	51111	51149	51548	51588	51750	54386	54537	54556	54799	55010	55063	55086	55135	55183	55257	5531	55929	56154	56893	56916	56941	56979	57599	57634	5788	5888	5932	60	604	6118	63979	641	64110	64210	64769	6778	6830	6944	7014	7037	7040	7158	7292	7320	7454	7468	79915	80311	80314	80762	8089	8295	84083	84717	84787	84893	86	8607	8741	8914	8971	92797	940	9400	9466	958	9643	9984
    GOBP_REGULATION_OF_MITOTIC_RECOMBINATION	http://www.gsea-msigdb.org/gsea/msigdb/human/geneset/GOBP_REGULATION_OF_MITOTIC_RECOMBINATION	10111	126549	201516	2068	4292	4361	7014
    GOBP_MITOTIC_SPINDLE_ELONGATION	http://www.gsea-msigdb.org/gsea/msigdb/human/geneset/GOBP_MITOTIC_SPINDLE_ELONGATION	24137	285643	29127	332	3619	4926	54627	55143	6795	9055	9212	9493

    ```
    </details>

    MAGMA gene-set 파일은 1 + &#945; columns로 SET, &#945; number of genes in the set 으로 구성되어야 함.  
    `gmt`파일에는 두번째 column에 URL이 포함되어 있어서, `examples/magma/geneset/01_modify_gmt.py` script로 수정해 주었음.  

7. MAGMA Gene-set analysis: Binary gene-set
    - Script: `examples/magma/05_geneset.sh`
    - Input:
        - genes.raw file: `examples/magma/AN_genebased.genes.raw`
        - gene set file: `examples/magma/geneset/c5.go.bp.v2023.1.Hs.entrez.gmt.modified`  
        1 + &#945; columns: Gene set name, &#945; number of genes included in the corresponding gene-set  
            <details>
            <summary>Click to toggle first 3 rows of gene set file</summary>

            ```
            GOBP_MITOCHONDRIAL_GENOME_MAINTENANCE	10000	10891	11232	142	1763	1890	201163	201973	2021	219736	291	3980	4205	4358	4976	50484	5428	55186	56652	6240	64863	6742	7156	7157	79736	80119	83667	84275	9093	92667	9361
            GOBP_REPRODUCTION	100	10007	100125288	100130958	100130988	100131137	100137049	10017	10018	100289087	10038	10046	10049	100506013	100507650	10051	10096	10097	100996631	10111	10116	10134	10149	10155	1017	10179	10184	101927581	101928601	10265	1027	102724560	1028	10343	10361	10370	10388	10393	10403	10406	10407	10409	10420	10426	10461	10468	1047	10481	10491	10497	1051	10519	10522	10524	10549	10560	10566	10574	10575	10576	10592	1060	10609	10635	10653	10655	10657	10658	10661	1069	10694	10699	10732	10733	10734	10735	10744	10765	10766	107983988	1080	1081	10818	1082	10844	10863	10876	10881	109	10916	10919	10927	10935	10942	10959	10983	10991	11020	11022	11055	11057	11063	11077	11085	11086	11105	11144	11189	11218	11251	113	11315	11331	113451	113746	114112	114791	115948	116	116138	116369	1164	116832	117	117144	117154	117155	117285	119504	119710	120892	121355	122042	122258	122402	122664	1235	124404	124626	124783	124817	124912	125972	126206	126549	1268	1271	127579	128153	128497	128637	130399	130497	1307	130951	131118	131375	132141	132243	132612	132625	133	133308	133558	135138	135458	135927	135935	136242	136332	1364	136991	138474	1390	1392	139212	1393	1394	1396	139886	1399	140732	140801	140894	140947	142	143471	1435	143678	143689	144132	144195	144406	144455	144535	145645	1459	146310	146378	146845	146849	146852	146956	147650	147700	147872	147912	148229	148281	148327	149095	1495	149685	1499	150	150159	150221	150280	150365	1508	150921	151	151056	151195	151246	151254	151449	151648	152006	152015	1525	152586	153218	1538	1539	154197	1543	154313	1545	157506	157680	157695	157777	157855	158062	158401	1586	1588	1594	159686	1602	160762	161142	161514	1617	1618	161829	161931	1620	1621	162540	162979	163589	1636	164045	164091	1642	164395	164684	164714	1654	166378	167	1672	168391	169981	170370	170506	170690	171169	171482	171483	171484	1718	1730	1731	1738	1739	174	1761	1767	1785	1788	18	181	1811	1812	1816	182	1822	1828	183	1833	1843	1869	190	1906	1909	1910	1912	192670	1958	197342	199223	199720	2	200162	200232	200373	200558	201164	201254	2013	202051	202500	2026	203074	203102	203523	203611	204474	2054	2056	2057	2067	2069	207	2072	2099	2120	2175	2176	2177	2182	2185	2189	2192	219670	219771	219793	219938	219990	221400	221481	221656	221711	221823	222698	2241	2253	2254	2255	225689	226	2263	22803	22836	22862	22873	2288	22887	22917	22933	22948	2295	2296	22994	22999	2302	23064	23139	23157	23198	23205	23213	23230	23236	23291	23304	23310	23315	23318	23345	23353	23394	23397	23399	23411	23414	23424	2348	23492	2350	2352	2353	2354	23542	23598	23609	23617	23626	23627	23633	23639	23641	23705	23742	23762	23764	23780	24145	24149	245711	246184	246777	247	2475	2488	249	2491	2492	2515	2516	2528	2529	253175	253943	254394	254528	255061	255101	255220	255626	2560	256006	256126	256710	257044	257062	25777	25788	25790	25809	2583	25831	25836	25847	25858	259	25906	2591	25911	259266	2593	25932	25945	25976	25981	26003	26038	26064	26091	26108	26140	26165	261734	2620	26206	2622	2623	2625	26255	26256	2626	2627	26271	26292	26330	26471	26476	2649	26528	2660	26609	2661	2662	26664	2674	2678	268	2683	269	2692	2693	2695	2697	26998	27019	27030	2706	2707	2709	2712	27120	27125	27127	27136	27161	27175	27229	27285	27306	2735	2741	2743	27443	2796	2801	2827	283	283129	2834	283417	283471	283629	283677	283847	284067	284071	284338	284359	284382	284680	285	285335	285498	285588	286128	286151	286207	286234	286464	286826	2879	28981	2908	29118	29127	2956	2959	29781	29844	29882	29893	29924	29945	29947	29974	29988	30014	301	3010	3014	3024	3037	3066	3073	3074	30812	3148	3169	3171	3172	317719	317761	3205	3206	3207	3209	3235	3236	3239	3248	326340	3267	3291	3293	3295	3298	330	3301	3305	3306	3309	3364	3371	338	338323	338773	338879	339168	339345	339829	339834	339906	3400	340069	340719	340784	341277	341567	3417	342977	344018	344758	346288	346653	346673	347688	347732	3479	3480	3482	3485	3488	3490	349152	351	3516	353189	3549	3552	3553	3566	3593	361	3619	3620	3622	3623	3624	3625	3633	3640	3643	3645	367	3673	3675	3678	3688	3690	3691	3714	3726	373861	373863	374	374768	375189	3753	375337	375341	377630	378708	378807	378948	3791	3814	3815	383	3856	3857	387712	387885	3880	388336	388553	388649	388799	389320	389730	389761	389762	389763	389852	390243	391714	3948	3952	3953	3955	3965	397	3972	3973	3975	3976	3985	399949	400629	401024	4012	402381	402573	4033	4036	406	406949	406950	406991	4086	4089	409	4090	4117	412	4142	4179	4184	4188	4192	4201	4216	4221	4240	4254	4292	4313	431705	431707	4318	4323	4327	4342	4361	43847	440699	440804	440822	441161	441452	441531	442867	442868	4436	4438	4439	4486	4487	4488	449520	4521	4543	4603	4627	4678	4683	4693	472	4735	474343	4751	4753	4762	480	4808	4809	4824	4838	4846	4851	4861	4867	4878	4880	4882	4889	49	4914	4920	4926	493	494551	4948	4956	4957	497189	49855	4986	4987	4988	4991	5000	5010	5016	5017	5020	5021	5023	5028	5047	5048	50487	5049	5050	50511	5066	5069	5073	5079	50846	5087	51	5104	51087	5111	51156	51207	51247	5125	5127	51298	51314	51343	51361	5139	51433	51434	51441	51460	51465	51529	5154	51542	51547	5156	51574	5159	51665	51668	51673	51686	51738	51742	51759	5176	51804	51807	5224	5228	5232	5238	5241	5266	5268	5270	5310	5324	5327	53340	53405	5347	5350	5360	5367	5368	538	54106	5414	54361	54407	54456	54457	54466	54514	54558	54585	54586	546	5467	5469	54742	54760	54763	54851	54852	54888	54890	54937	54970	54993	55036	55063	55064	551	55120	55124	5515	5518	552	55231	55329	55339	55342	5535	55366	55521	55585	55636	5566	5568	55706	5571	55723	55726	55743	55779	558	55810	55811	55815	55818	55840	55870	55905	5591	56	5608	56154	56155	56158	56159	56163	56165	5617	5618	5619	5620	56262	56339	5660	56603	56648	5669	5670	5671	5672	56729	5673	5675	5676	56776	5678	5680	56848	56853	56907	56956	56977	56979	57054	57055	57082	57095	57097	57113	57119	57122	57135	57151	57178	5719	572	5724	5727	5729	5730	5737	5743	5744	57446	57587	57599	5764	57647	57697	57721	57728	57731	578	5781	57820	57828	57829	5798	5806	581	5810	5819	582	583	58494	585	58524	58531	5858	5864	5872	5885	5887	5888	5889	5890	5892	5901	5914	5916	5925	5926	59272	5932	59338	59343	59350	595	5950	596	5972	598	5987	599	5990	5997	6013	6019	604	6045	6046	60675	6092	6098	6117	6159	6194	619556	6196	6198	6299	6305	638	6382	63894	639	63946	63948	63950	63951	63978	63979	6406	6407	64100	6414	64147	64207	6422	64220	64224	6423	642623	642636	642658	64321	643376	64395	64396	644150	644186	64478	644890	64518	645832	64591	645961	646	6461	64645	646480	646799	64682	6469	647060	64750	64753	6477	64847	64848	6498	65010	65110	6513	652	6522	653	6532	654	655	657	6573	658	6586	659	6595	66037	6615	6627	6647	6652	6654	6658	666	6662	6665	6670	6674	6676	6677	668	6690	6691	6696	6714	6715	6716	6732	6736	675	6751	6752	6753	676	6768	6774	6777	6781	6788	6789	6790	6794	6795	6812	682	6833	6847	6863	6865	6866	6869	6870	6874	6875	6895	6901	6926	694	6943	6950	6954	699	7004	7005	701	7013	7016	7022	7026	7042	7043	7046	7048	7054	7056	7067	7068	7073	7076	7079	708	7080	7098	7103	7110	7130	7141	7142	7153	7155	7156	718	7182	7203	7216	7222	7225	7226	7257	7258	7272	727830	727905	728132	728137	7283	728395	728403	728637	728695	728712	729201	729967	7301	730249	7314	7320	7337	734	7345	7349	7351	7356	7372	7417	7421	7422	7425	7432	7455	7458	7473	7474	7476	7482	7484	7490	7516	7528	7536	7584	7589	768239	7704	7707	771	7783	7784	780	7812	7855	78995	79084	7917	79173	7932	79400	79582	796	79645	79670	79703	79727	79733	79747	79816	79820	79846	79893	79925	7993	79969	79977	79989	80000	80010	80025	80198	80217	80237	8031	80314	8061	80705	8085	8086	811	81492	81539	81616	81623	81626	81629	81671	81833	81892	81930	8195	8204	8239	824	8243	8287	8320	8322	83447	83449	835	83540	836	83639	83700	8372	8382	83853	83890	83893	83942	83943	8398	83983	8399	83990	84056	84057	84071	84072	84073	84074	841	84132	84152	84159	84168	84172	84203	84215	84221	84223	84225	84229	84236	8433	8434	8438	84464	84501	84515	84519	84660	84678	8468	84687	84688	84690	84691	84694	84733	84750	84812	84868	84930	84944	8510	8521	8528	8531	85315	85360	85376	85378	85413	85417	85438	8546	8549	8605	8607	8614	8626	8633	8644	8653	8654	867	8697	8701	8743	8747	8748	8749	875	8751	881	8820	8852	8879	8881	8890	8892	8893	8894	8900	8909	8912	8924	8932	89765	89766	898	89869	89876	89887	8999	90	9025	90410	90780	9082	9083	9085	90853	91	9104	9125	9126	9130	9133	9134	9148	9156	91603	91646	91746	9183	9184	9191	91978	92	9210	9232	9241	9271	928	9289	93185	9319	93426	9353	93649	9389	94027	9403	94107	9420	9421	9425	9426	9444	9463	9468	9509	9510	9514	9519	952	9575	9576	9612	9633	9665	9667	9698	9700	9702	9724	9825	983	989	9897	9898	991	9918	993	994	9940	995	996	9985
            GOBP_SINGLE_STRAND_BREAK_REPAIR	100133315	1161	142	200558	2074	23411	3981	54840	55775	7014	7141	7515
            ```
            
            </details>

    - Output:
        - log file: `examples/magma/AN_geneset.log`
            <details>
            <summary>Click to toggle the content of the log file</summary>

            ```
            Welcome to MAGMA v1.10 (linux)
            Using flags:
                --gene-results AN_genebased.genes.raw
                --set-annot ./geneset/c5.go.bp.v2023.1.Hs.entrez.gmt.modified
                --out AN_geneset

            Start time is 19:43:17, Tuesday 21 Mar 2023

            Reading file AN_genebased.genes.raw... 
                17825 genes read from file
            Loading gene-set annotation...
            Reading file ./geneset/c5.go.bp.v2023.1.Hs.entrez.gmt.modified... 
                WARNING: gene set GOBP_FORMATION_OF_QUADRUPLE_SL_U4_U5_U6_SNRNP contains no genes defined in genotype data
                WARNING: gene set GOBP_NEGATIVE_REGULATION_OF_INTERLEUKIN_21_PRODUCTION contains no genes defined in genotype data
                WARNING: gene set GOBP_REGULATION_OF_BMP_SECRETION contains no genes defined in genotype data
                7751 gene-set definitions read from file
                found 7748 gene sets containing genes defined in genotype data (containing a total of 15094 unique genes)
            Preparing variables for analysis...
                truncating Z-scores 3 points below zero or 6 standard deviations above the mean
                WARNING: discarding gene set 'GOBP_NEGATIVE_REGULATION_OF_INTERLEUKIN_6_MEDIATED_SIGNALING_PATHWAY' from file ./geneset/c5.go.bp.v2023.1.Hs.entrez.gmt.modified, variance is too low (set contains only one gene used in analysis)
                WARNING: discarding gene set 'GOBP_NEGATIVE_REGULATION_OF_VASCULAR_ENDOTHELIAL_GROWTH_FACTOR_PRODUCTION' from file ./geneset/c5.go.bp.v2023.1.Hs.entrez.gmt.modified, variance is too low (set contains only one gene used in analysis)
                WARNING: discarding gene set 'GOBP_NEGATIVE_REGULATION_OF_MATRIX_METALLOPEPTIDASE_SECRETION' from file ./geneset/c5.go.bp.v2023.1.Hs.entrez.gmt.modified, variance is too low (set contains only one gene used in analysis)
                WARNING: discarding gene set 'GOBP_NEGATIVE_REGULATION_OF_CELL_CHEMOTAXIS_TO_FIBROBLAST_GROWTH_FACTOR' from file ./geneset/c5.go.bp.v2023.1.Hs.entrez.gmt.modified, variance is too low (set contains only one gene used in analysis)
                truncating covariate values more than 5 standard deviations from the mean
                total variables available for analysis: 7744 gene sets

            Parsing model specifications...
            Inverting gene-gene correlation matrix...
            Performing regression analysis...
                testing direction: one-sided, positive (sets), two-sided (covar)
                conditioning on internal variables:
                    gene size, log(gene size)
                    gene density, log(gene density)
                    sample size, log(sample size)
                    inverse mac, log(inverse mac)
                analysing individual variables

                analysing single-variable models (number of models: 7744)
                writing results to file AN_geneset.gsa.out

            End time is 19:43:33, Tuesday 21 Mar 2023 (elapsed: 00:00:16)

            ```

            </details>
        - gsa.out file: `examples/magma/AN_geneset.gsa.out`
            <details>
            <summary>Click to toggle first 10 rows of gsa.out file</summary>

            ```
            # MEAN_SAMPLE_SIZE = 24311
            # TOTAL_GENES = 17825
            # TEST_DIRECTION = one-sided, positive (set), two-sided (covar)
            # CONDITIONED_INTERNAL = gene size, gene density, sample size, inverse mac, log(gene size), log(gene density), log(sample size), log(inverse mac)
            VARIABLE                                TYPE  NGENES         BETA     BETA_STD           SE            P FULL_NAME
            GOBP_MITOCHONDRIAL_GENOME_MA...          SET      31      0.10274    0.0042808      0.15388      0.25219 GOBP_MITOCHONDRIAL_GENOME_MAINTENANCE
            GOBP_REPRODUCTION                        SET    1371     0.019928    0.0053101     0.024079      0.20395 GOBP_REPRODUCTION
            GOBP_SINGLE_STRAND_BREAK_REP...          SET      11      0.25972      0.00645      0.27037      0.16839 GOBP_SINGLE_STRAND_BREAK_REPAIR
            GOBP_REGULATION_OF_DNA_RECOM...          SET     122     0.027402    0.0022593     0.076554       0.3602 GOBP_REGULATION_OF_DNA_RECOMBINATION
            GOBP_REGULATION_OF_MITOTIC_R...          SET       7      0.32411    0.0064218      0.30696      0.14552 GOBP_REGULATION_OF_MITOTIC_RECOMBINATION
            ```

            </details>

8. MAGMA gene-set analysis: continuous gene-set  
Boulder Workshop 2021의 MAGMA session에서 제공하는 `tissue_gex.cov` 파일 활용해서.  
    <details>
    <summary>Click to toggle first 6 rows of tissue_gex.cov file</summary>

    ```
    GENE    ARTERY_EXPR     BLOOD_EXPR      BRAIN_EXPR      COLON_EXPR      ESOPHAGUS_EXPR  HEART_EXPR      KIDNEY_EXPR     LIVER_EXPR      LUNG_EXPR       PANCREAS_EXPR   SKIN_EXPR       AVERAGE_EXPR
    8452    0.02214 0.0569  1.44143270101962        0.01705 0.01264 0.03492 0.05225 0.01402 0.02608 0.01337 0.02459 0.155944791001783
    8553    0.13884 0.00772 1.78924141330184        0.05393 0.04224 0.08391 0.03966 0.08036 0.19548 0.04403 0.02279 0.227109219391076
    3275    0.65977 0.21095 -0.163840579196644      0.6253  0.72624 0.35988 0.33137 0.16072 1.07963 0.14907 0.68307 0.438378129163941
    84689   0.00376 0.00571 0.0400852149574668      0.01845 0.00057 0.0065  0       0.00039 0.00551 0.00066 0.00156 0.0075632013597697
    3290    0.48091 0.34491 0.496651126863354       0.63244 0.38055 0.3555  0.89248 0.86411 0.61831 0.84901 0.70618 0.601913738805759
    ```
    </details>  

    - Script: `examples/magma/06_geneset_continuous.sh`
    - Input:
        - genes.raw file: `examples/magma/AN_genebased.genes.raw`
        - gene set file: `examples/magma/geneset/tissue_gex.cov`  
    - Output:  
        - log file: `examples/magma/AN_geneset_cont.log`  
            <details>
            <summary>Click to toggle the content of the log file</summary>

            ```
            Welcome to MAGMA v1.10 (linux)
            Using flags:
                --gene-results AN_genebased.genes.raw
                --gene-covar ./geneset/tissue_gex.cov
                --out AN_geneset_cont

            Start time is 20:11:29, Tuesday 21 Mar 2023

            Reading file AN_genebased.genes.raw... 
                17825 genes read from file
            Loading gene-level covariates...
            Reading file ./geneset/tissue_gex.cov... 
                detected 12 variables in file (using all)
                found 12 valid gene covariates, for 13090 genes defined in genotype data
            Processing missing values...
                found 4735 genes not present in all input files: removing these from analysis
                13090 genes remaining in analysis
            Preparing variables for analysis...
                truncating Z-scores 3 points below zero or 6 standard deviations above the mean
                truncating covariate values more than 5 standard deviations from the mean
                total variables available for analysis: 12 gene covariates

            Parsing model specifications...
            Inverting gene-gene correlation matrix...
            Performing regression analysis...
                testing direction: one-sided, positive (sets), two-sided (covar)
                conditioning on internal variables:
                    gene size, log(gene size)
                    gene density, log(gene density)
                    sample size, log(sample size)
                    inverse mac, log(inverse mac)
                analysing individual variables

                analysing single-variable models (number of models: 12)
                writing results to file AN_geneset_cont.gsa.out

            End time is 20:11:35, Tuesday 21 Mar 2023 (elapsed: 00:00:06)

            ```

            </details>
        - gsa.out file: `examples/magma/AN_geneset_cont.gsa.out`
            <details>
            <summary>Click to toggle the content of the gsa.out file</summary>

            ```
            # MEAN_SAMPLE_SIZE = 24575
            # TOTAL_GENES = 13090
            # TEST_DIRECTION = one-sided, positive (set), two-sided (covar)
            # CONDITIONED_INTERNAL = gene size, gene density, sample size, inverse mac, log(gene size), log(gene density), log(sample size), log(inverse mac)
            VARIABLE            TYPE  NGENES         BETA     BETA_STD           SE            P
            ARTERY_EXPR        COVAR   13090   -0.0030723   -0.0052446    0.0045744      0.50183
            BLOOD_EXPR         COVAR   13090   -0.0048654    -0.007901    0.0047755      0.30831
            BRAIN_EXPR         COVAR   13090   -0.0015603   -0.0025856    0.0047545      0.74279
            COLON_EXPR         COVAR   13090  -0.00043783  -0.00074466    0.0046196      0.92449
            ESOPHAGUS_EXPR     COVAR   13090   -0.0021255   -0.0035827    0.0046216       0.6456
            HEART_EXPR         COVAR   13090  -4.8202e-05  -7.8854e-05    0.0047517      0.99191
            KIDNEY_EXPR        COVAR   13090   -0.0026251   -0.0042906    0.0047563      0.58101
            LIVER_EXPR         COVAR   13090   8.3383e-05   0.00013723    0.0047346      0.98595
            LUNG_EXPR          COVAR   13090   -0.0041656   -0.0069971     0.004626      0.36789
            PANCREAS_EXPR      COVAR   13090   -0.0033011    -0.005048    0.0050723      0.51518
            SKIN_EXPR          COVAR   13090   -0.0038498   -0.0065499    0.0045921      0.40185
            AVERAGE_EXPR       COVAR   13090   -0.0029997   -0.0044087    0.0053125      0.57232
            ```

            </details>


# Gene-set databases

- MSigDB: http://www.gsea-msigdb.org/gsea/index.jsp

